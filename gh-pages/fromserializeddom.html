<html><head>
<meta charset="utf-8">
<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="http://localhost:8080/dist/from.js"></script>
<link rel="stylesheet" href="fromjs.css">
</head><body>
<script>
window.isSerializedDomPage = true
window._disableTracing();

jQuery.get("./data.json", function(data){
    handleData(data)
})

function handleData(data){
    document.body.parentElement.innerHTML = data.html

    jQuery("[fromjs-id]").each(function(){
        var id = $(this).attr("fromjs-id")
        var elOrigin = data.elOrigins[id]
        elOrigin.contents = Array.prototype.slice.apply(this.childNodes, [])
        // elOrigin.contents = elOrigin.contents.map(function(origin){
        //     return $("[fromjs-id='" + origin.elId + "']")[0]
        // })
        this.__elOrigin = elOrigin
    })
    jQuery("[fromjs-text-node-converted-to-span]").each(function(){
        var textNode = document.createTextNode(this.textContent)
        textNode.__elOrigin = this.__elOrigin
        this.replacementTextNode = textNode
        $(this).replaceWith(textNode)
    })
    jQuery("[fromjs-id]").each(function(){
        this.__elOrigin.contents = this.__elOrigin.contents.map(function(el){
            if (el.replacementTextNode) {
                return el.replacementTextNode
            }
            return el
        })
    })
    jQuery("[fromjs-content-origin-id]").each(function(){
        var originId = $(this).attr("fromjs-content-origin-id");

        this.childNodes[0].__elOrigin = data.elOrigins[originId]
    })
    jQuery("[fromjs-id]").each(function(){
        $(this).removeAttr("fromjs-id")
    });
    setDefaultSourceCache(data.sourceCache)
    window.fromJSDynamicFileOrigins = data.fromJSDynamicFileOrigins

    doneRenderingApp()
}
</script>
</body></html>
